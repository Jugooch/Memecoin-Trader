# Memecoin Trading Bot Configuration Template
# Copy this file to config.yml and fill in your API keys

# Free RPC endpoint - no paid subscription needed
rpc_endpoint: "https://api.mainnet-beta.solana.com"

# BitQuery API Tokens - You can add multiple tokens for rotation
# Get from https://bitquery.io (sign up for free accounts)
bitquery_tokens:
  - your_first_bitquery_token_here
  - your_second_bitquery_token_here  # Optional: add more for rotation
  - your_third_bitquery_token_here   # Optional: add more for rotation

# Legacy single token support (will be converted to list)
bitquery_token: "your_bitquery_token_here"

# Pump Portal API configuration (recommended for real-time feeds)
pumpportal:
  api_key: "your_pumpportal_api_key_here"
  wallet_public_key: "your_wallet_public_key_here"    # Optional: for trading features
  wallet_private_key: "your_wallet_private_key_here"  # Optional: for trading features  
  ws_endpoint: "wss://pumpportal.fun/api/data"
  trade_endpoint: "https://pumpportal.fun/api/trade"

# Choose your real-time data source
realtime_source: "pumpportal"  # Options: "pumpportal" (recommended) or "bitquery"

# Moralis API Keys - You can add multiple keys for rotation
# Get from https://moralis.io (sign up for free accounts)
moralis_keys:
  - your_first_moralis_key_here
  - your_second_moralis_key_here  # Optional: add more for rotation
  - your_third_moralis_key_here   # Optional: add more for rotation

# Legacy single key support (will be converted to list)
moralis_key: your_moralis_key_here

# Optional QuickNode (only needed for automated live trading)
quicknode_endpoint: ""  # Leave empty to disable
quicknode_api_key: ""   # Leave empty to disable

# Alpha wallet addresses (discovered by alpha_discovery_v2.py)
watched_wallets:
  # Add proven alpha wallet addresses here
  # - wallet_address_1
  # - wallet_address_2

# Trading parameters (Phase 2: Bayesian Scoring)
alpha_weight_min: 2.5         # Minimum weighted vote score (replaces threshold_alpha_buys)
require_one_wallet_pge_55: false  # Require at least one wallet with >55% win rate (smart scoring handles this)
beta_prior_alpha: 3           # Bayesian prior alpha (wins + 1)
beta_prior_beta: 5            # Bayesian prior beta (losses + 1) = 37.5% baseline
threshold_alpha_buys: 3       # DEPRECATED - kept for backward compatibility

# Discovery Quality Controls (Phase 3: Quality Improvements)
discovery_position_filters:
  min_position_usd: 50        # Minimum position size to avoid noise traders
  max_position_usd: 5000      # Maximum position size to focus on skill vs capital
  
discovery_quality_checks:
  max_co_occurrence_rate: 0.8 # Flag wallets with >80% coordination with others
  min_tokens_for_check: 3     # Only check wallets with 3+ tokens for wash trading
  enable_wash_trading_detection: true  # Enable wash trading pattern detection
  enable_risk_adjusted_scoring: true   # Enable risk-adjusted performance scoring
  min_exit_quality: 0.3       # Minimum exit timing quality (0.0-1.0, 0.3 = 30th percentile)
  min_consistency: 0.2        # Minimum performance consistency (0.0-1.0, 0.2 = low variance)

# Enhanced alpha detection parameters
alpha_enhanced:
  min_independent_wallets: 2          # Require 2+ independent wallets
  correlation_time_threshold_ms: 250  # Co-buy time threshold
  correlation_penalty_frequent: 0.8   # Penalty for frequent co-buyers (5+)
  correlation_penalty_some: 0.9       # Penalty for some co-buying (3+)
  correlation_penalty_shared_funder: 0.8  # Penalty for shared funding source

min_liquidity_usd: 15000      # Minimum liquidity required (increased from 5000)
time_window_sec: 180          # Time window to wait for alpha activity (reduced from 300)
max_trade_pct: 0.05           # Max % of capital per trade (5%)
tp_multiplier: 1.25           # Take profit multiplier (1.25x - more realistic)
stop_loss_pct: 0.92           # Stop loss percentage (8% loss - tighter stop)
max_hold_seconds: 900         # Maximum time to hold position (15 minutes)

# Scratch rule parameters
scratch_rule:
  enabled: true                       # Enable scratch exits
  max_time_seconds: 45                # Only scratch in first 45s
  drawdown_threshold: 0.04            # 4% peak drawdown threshold
  exit_range_low: -0.03               # Scratch between -3% and -2%
  exit_range_high: -0.02
  buyer_acceleration_window: 30       # Window for buyer acceleration calc

# Token processing optimization (reduces Moralis API calls)
min_token_age_seconds: 10     # Wait time before checking Moralis (allows indexing)
alpha_first_strategy: true    # Check alpha activity before calling Moralis APIs

# Trading execution mode
trading_mode: "simulation"    # Options: "simulation", "alerts", "auto"
# simulation = Paper trading only
# alerts = Generate buy/sell alerts for manual execution  
# auto = Fully automated trading (requires QuickNode)

# Trading limits
trading:
  initial_capital: 500.0      # Starting capital ($) - optimized for $15-25 trades
  max_trades_per_day: 20      # Daily trade limit (reasonable for active trading)
  min_time_between_trades: 120 # Minimum seconds between trades (2 minutes to avoid overtrading)
  max_concurrent_positions: 3  # Maximum positions open at once
  
# Paper trading simulation parameters
paper_trading:
  fee_bps: 30                 # Trading fee in basis points (0.30%)
  buy_slippage_bps: 75        # Expected buy slippage (0.75%)
  sell_slippage_bps: 100      # Expected sell slippage (1.00%)
  max_slippage_bps: 150      # Maximum acceptable slippage (1.50%)

# API optimization settings
api_optimization:
  # Moralis cache TTLs (seconds)
  price_ttl: 8               # Price cache (use fresh=True for monitoring)  
  liquidity_ttl: 600         # Liquidity cache (10 minutes)
  swaps_ttl: 30              # Swaps cache (30s default, 10s for alpha)
  swaps_alpha_ttl: 10        # Faster updates during alpha checks
  
  # Alpha check optimization  
  alpha_polls_max: 3         # Maximum polls per alpha check
  alpha_poll_intervals: [5, 20, 40]  # Poll timing in seconds
  alpha_swap_limit: 50       # Swap limit per poll (reduced from 100)
  alpha_early_abort_min_buyers: 10   # Early abort threshold
  alpha_early_abort_buy_sell_ratio: 1.0  # Early abort ratio
  
  # Discovery V2 optimization (updated for more alpha wallets)
  discovery_max_moralis_tokens: 50    # Validate top 50 tokens (increased from 20)
  discovery_bitquery_success_threshold: 25  # Lower threshold (reduced from 40)
  discovery_early_window_minutes: 10  # Early buyer window (increased from 5)
  
  # Multi-tier alpha wallet discovery
  discovery_success_thresholds:
    high: 2.0     # 2x performance = high success 
    medium: 1.5   # 1.5x performance = medium success
    low: 1.2      # 1.2x performance = low success
  
  discovery_min_appearances:
    tier_1: 2     # Premium: 2+ high success tokens
    tier_2: 3     # Good: 3+ medium success tokens  
    tier_3: 4     # Emerging: 4+ low success tokens

# Pump.fun configuration
pump_fun:
  program_address: "6EF8rrecthHAuSStzpf6aXr9HWs8jgPVr5S6fqF6P"
  api_endpoint: "https://pumpapi.fun"
  
# Enhanced safety checks
safety:
  require_sellability: true          # Check for recent sells (honeypot detection)
  max_price_impact: 0.008             # Maximum acceptable price impact (0.8% - tightened)
  sellability_window: 90              # Look for sells in last N seconds (increased from 60)
  min_distinct_sellers: 3             # Require 3+ distinct sellers (enhanced)
  max_sell_failure_rate: 0.05         # Max 5% sell failure rate (enhanced)
  hold_through_entry_check: true      # Enable copy-trade bait detection
  hold_through_window_seconds: 20     # Window to check for early exits
  price_extension_guard: true         # Enable price extension guard
  price_extension_percentile: 95      # Reject if price > p95 of last 60s
  
# Adaptive risk management (Phase 4.2)
risk_management:
  enabled: true               # Enable adaptive risk management
  position_size_pct: 0.05    # NEVER changes - always 5% to avoid fees
  # Risk levels based on daily P&L
  levels:
    normal:                  # 0% or positive P&L
      min_wallets: 3
      min_weight: 2.5
      max_daily_trades: 20
      min_time_between: 120
    cautious:                # -2% P&L
      min_wallets: 4
      min_weight: 3.0
      max_daily_trades: 15
      min_time_between: 180
    conservative:            # -4% P&L
      min_wallets: 5
      min_weight: 3.5
      max_daily_trades: 10
      min_time_between: 300
    defensive:               # -6% P&L or worse
      min_wallets: 6
      min_weight: 4.0
      max_daily_trades: 5
      min_time_between: 600

# Logging configuration
logging:
  level: "INFO"               # DEBUG, INFO, WARNING, ERROR
  file: "logs/trading.log"

# Database configuration
database:
  file: "trades.db"

# Discord notifications (optional but recommended)
# To get webhook URL: Server Settings -> Integrations -> Webhooks -> New Webhook
notifications:
  discord_webhook_url: ""  # Leave empty to disable Discord notifications
  enabled: true           # Toggle notifications on/off